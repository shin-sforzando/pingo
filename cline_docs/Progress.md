# 進捗状況

## 現在の状態

Pingoプロジェクトは現在、機能実装段階に入っています。基礎構築が完了し、ゲーム作成機能の実装を進めています。

> [!NOTE]
> 詳細な要件や設計の情報については、 `./cline_docs/TechnicalSpecification.md` を参照してください。
> 過去の開発履歴については、 `./cline_docs/Archived_20250514.md` を参照してください。

## 最近の変更

- ヘッダーコンポーネントの拡張
  - UserMenuコンポーネントの実装
    - ユーザー名の1文字目を丸く囲ったAvatarの表示
    - ドロップダウンメニューの実装（プロフィールリンク、言語切り替え、参加中ゲーム一覧、ログアウト）
    - 認証状態に応じた表示切り替え
  - NotificationIconコンポーネントの実装
    - 通知アイコンの表示と未読通知の強調表示
    - 通知ドロワーの表示機能
  - NotificationDrawerコンポーネントの拡張
    - ダミー通知データの表示
    - 通知メッセージの多言語対応
    - 未読/既読状態の視覚的表現
  - 翻訳キーの追加
    - すべてのNotificationType列挙型に対応する翻訳キーの追加
    - Header関連の翻訳キーの追加
- ゲーム新規作成画面および機能の実装
  - ゲーム作成フォームの実装
    - タイトル、テーマの入力フィールド
    - 被写体候補リストの編集機能
    - ビンゴボードのプレビュー表示
  - 被写体候補リスト管理コンポーネントの実装
    - SubjectItemコンポーネント（文字列入力、削除ボタン、採用/非採用状態表示）
    - SubjectListコンポーネント（ドラッグ＆ドロップ並び替え、新規追加ボタン）
    - 最初から24個の被写体候補を表示する機能
  - ビンゴボードプレビューコンポーネントの実装
    - 5x5グリッドの表示
    - 中央のFREEセルの表示
    - 被写体候補の変更に応じたリアルタイム更新
  - 多言語対応（日英）の実装
    - 翻訳キーの追加と適用
    - プレースホルダーの翻訳
  - Hydrationエラーの修正
    - useIdを使用した安定したID生成
    - サーバーとクライアントで一貫したレンダリング
  - フォーム送信とボタン操作の改善
    - type="button"属性の追加によるリダイレクト問題の解決
    - エラーハンドリングの強化
  - デバッグ機能の追加
    - 認証状態の確認
    - APIレスポンスのログ出力
- Google Gemini APIとの連携
  - 被写体候補生成API（`/api/subjects/generate`）の実装
    - タイトルとテーマに基づいた被写体候補の生成
    - 言語設定（日本語/英語）に応じた候補の生成
    - ユーザーのロケール設定の考慮
    - 公序良俗に反するタイトルやテーマのチェック
    - エラーハンドリングとレスポンス処理
  - 被写体候補チェックAPI（`/api/subjects/check`）の実装
    - 被写体候補が以下の条件を満たすかチェック：
      1. 具体的な名詞または短い記述的フレーズであること
      2. 写真で視覚的に識別可能であること
      3. Google Cloud Vision AIで認識可能であること
      4. プレイヤーが何を撮影すべきか理解できるよう、曖昧さが少ないこと
      5. 全年齢向けであること（不適切なコンテンツを含まない）
      6. リスト内で重複していないこと
    - 言語設定（日本語/英語）に応じたチェック
    - ユーザーのロケール設定の考慮
    - 問題がある場合は、問題のある被写体とその理由を返す
  - 包括的なテストの実装
    - 入力バリデーションのテスト
    - 言語設定のテスト（日本語と英語の両方）
    - 公序良俗チェックのテスト（日本語と英語の両方）
    - 抽象的な概念、曖昧な表現、不適切なコンテンツ、重複項目のテスト
    - 生成APIとチェックAPIの統合テスト

## 次のステップ

優先度に基づいて、以下の順序で開発を進めていきます：

- 認証系の実装（Firebase Authentication）
  - 認証状態に合わせたUIの変更
  - 認証済みユーザーのみがアクセスできるページの保護
- 基本コンポーネントの実装と拡充
  - ビンゴボードコンポーネントの機能拡張
    - CLOSE, OPEN状態の表現
    - 揃った列の強調表示
    - モバイル対応レスポンシブデザインの改善
  - 画像アップロードコンポーネント
  - ゲーム作成フォームの機能拡張
    - 難易度設定の追加
    - AIの判定確信度閾値設定
    - ビンゴ列数設定
    - 写真共有設定
    - 被写体候補生成APIとチェックAPIの統合
  - ゲーム参加フォーム
- Firebaseとの連携
  - ゲームデータの保存と取得
  - ユーザーデータの管理
  - 画像のアップロードと取得

## アクティブな決定事項と検討事項

### 検討中の事項

現時点では、主要な検討事項はすべて決定済みです。今後の開発過程で新たな検討事項が発生した場合は、ここに追加していきます。

## 残りの作業

T. B. D.

## 既知の問題

T. B. D.
